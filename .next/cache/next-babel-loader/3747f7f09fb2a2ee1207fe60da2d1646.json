{"ast":null,"code":"var _jsxFileName = \"/Users/tkak/sample/next5/villageon/pages/sign/signup.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Layout from '../../components/layout';\nimport Head from 'next/head';\nimport styles from '../../styles/sign.module.scss';\nimport { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport Router from 'next/router';\nimport initFirebase from '../../components/initFirebase';\nimport firebase from \"firebase/app\";\nimport 'firebase/auth';\n\nrequire('firebase/auth');\n\nrequire(\"firebase/firestore\");\n\ninitFirebase();\nvar db = firebase.firestore();\nexport default function SignUp() {\n  //input\n  const {\n    0: mail,\n    1: setMail\n  } = useState(\"\");\n  const {\n    0: password,\n    1: setPassword\n  } = useState(\"\");\n  const {\n    0: togglePassword,\n    1: setTogglePassword\n  } = useState(false);\n  const {\n    0: LastName,\n    1: setLastName\n  } = useState(\"\");\n  const {\n    0: FirstName,\n    1: setFirstName\n  } = useState(\"\");\n  const {\n    0: gender,\n    1: setGender\n  } = useState(\"\"); //error\n\n  const {\n    0: mailError,\n    1: setMailError\n  } = useState(\"\");\n  const {\n    0: passwordError,\n    1: setPasswordError\n  } = useState(\"\");\n  const {\n    0: LastNameError,\n    1: setLastNameError\n  } = useState(\"\");\n  const {\n    0: FirstNameError,\n    1: setFirstNameError\n  } = useState(\"\");\n  const {\n    0: genderError,\n    1: setGenderError\n  } = useState(\"\");\n  const {\n    0: check,\n    1: setCheck\n  } = useState(false);\n  const {\n    0: alert,\n    1: setAlert\n  } = useState(\"\"); //db\n\n  const {\n    0: mount,\n    1: setMount\n  } = useState(true); //verification\n\n  useEffect(() => {\n    if (mount) {\n      var user = firebase.auth().currentUser;\n\n      if (user) {\n        if (false) {\n          Router.push(\"/user/details\");\n        }\n      }\n      /*\n      firebase.auth().onAuthStateChanged(function(user) {\n          if (user) {\n              // User is signed in.\n              if (process.browser) {\n                  Router.push(\"/\")\n              }\n          } else {\n              // No user is signed in.\n          }\n      })\n      */\n\n    }\n\n    return function cleanup() {\n      setMount(false);\n    };\n  });\n\n  const changeLastName = event => {\n    const LastName = event.target.value;\n    setLastName(LastName);\n  };\n\n  const changeFirstName = event => {\n    const FirstName = event.target.value;\n    setFirstName(FirstName);\n  };\n\n  const changeMail = event => {\n    const mail = event.target.value;\n    setMail(mail);\n  };\n\n  const changePassword = event => {\n    const password = event.target.value;\n    setPassword(password);\n  };\n\n  const handleSubmit = () => {\n    setFirstNameError(\"\");\n    setLastNameError(\"\");\n    setMailError(\"\");\n    setPasswordError(\"\");\n    setAlert(\"\");\n    firebase.auth().createUserWithEmailAndPassword(mail, password).then(function () {\n      var user = firebase.auth().currentUser;\n      user.updateProfile({\n        displayName: `${LastName} ${FirstName}`\n      });\n      db.collection(\"users\").doc(user.uid).set({\n        apllication: [],\n        admin: false,\n        gender: gender,\n        first: FirstName,\n        last: LastName,\n        mail: mail\n      }).then(function () {}).catch(function (error) {});\n      submitVerification();\n    }).catch(function (error) {\n      var errorCode = error.code;\n      var errorMessage = error.message;\n\n      if (errorCode == 'auth/invalid-email') {\n        setMailError(\"正しいメールアドレスを入力してください\");\n      } else if (errorCode == 'auth/email-already-in-use') {\n        setMailError(\"既に使われています\");\n      } else if (errorCode == 'auth/weak-password') {\n        setPasswordError(\"6文字以上で設定してください\");\n      } else if (errorCode == 'auth/operation-not-allowed') {\n        setMailError(\"メールアドレスを入力してください\");\n      } else {\n        setPasswordError(errorMessage);\n      }\n    });\n  };\n\n  const checkAlert = () => {\n    setFirstNameError(\"\");\n    setLastNameError(\"\");\n    setMailError(\"\");\n    setPasswordError(\"\");\n    setAlert(\"\");\n\n    if (!FirstName) {\n      setFirstNameError(\"入力してください\");\n    }\n\n    if (!LastName) {\n      setLastNameError(\"入力してください\");\n    }\n\n    if (!mail) {\n      setMailError(\"入力してください\");\n    }\n\n    if (!password) {\n      setPasswordError(\"入力してください\");\n    }\n\n    if (!check) {\n      setAlert(\"利用規約に同意してください\");\n    }\n\n    if (gender) {\n      setGenderError(\"入力してください\");\n    }\n  };\n\n  const toggleChack = () => {\n    setCheck(!check);\n    setAlert(\"\");\n  };\n\n  const changeGender = event => {\n    var gender = event.target.value;\n    setGender(gender);\n  };\n\n  const submitVerification = () => {\n    var actionCodeSettings = {\n      url: \"http://localhost:3000/user/details\"\n    };\n    var user = firebase.auth().currentUser;\n    user.sendEmailVerification(actionCodeSettings).then(function () {\n      if (false) {\n        Router.push(\"/sign/verification\");\n      }\n    });\n  };\n\n  const togglePasswordDisplay = () => {\n    setTogglePassword(!togglePassword);\n  };\n\n  return __jsx(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 9\n    }\n  }, __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 13\n    }\n  }, __jsx(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 17\n    }\n  }, \"SignUp\")), __jsx(\"article\", {\n    className: styles.signWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 13\n    }\n  }, __jsx(\"h1\", {\n    className: styles.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 17\n    }\n  }, \"\\u30A2\\u30AB\\u30A6\\u30F3\\u30C8\\u306E\\u4F5C\\u6210\"), __jsx(\"form\", {\n    className: styles.form,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    className: styles.nameWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 21\n    }\n  }, __jsx(\"input\", {\n    className: styles.name,\n    type: \"text\",\n    placeholder: \"\\u59D3\",\n    onChange: changeLastName,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 25\n    }\n  }), __jsx(\"input\", {\n    className: styles.name,\n    type: \"text\",\n    placeholder: \"\\u540D\",\n    onChange: changeFirstName,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 25\n    }\n  })), __jsx(\"div\", {\n    className: styles.nameWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 21\n    }\n  }, __jsx(\"p\", {\n    className: styles.alert,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 25\n    }\n  }, LastNameError), __jsx(\"p\", {\n    className: styles.alert,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 25\n    }\n  }, FirstNameError)), __jsx(\"input\", {\n    className: styles.input,\n    type: \"text\",\n    placeholder: \"\\u30E1\\u30FC\\u30EB\\u30A2\\u30C9\\u30EC\\u30B9\",\n    onChange: changeMail,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 21\n    }\n  }), __jsx(\"p\", {\n    className: styles.alert,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 21\n    }\n  }, mailError), __jsx(\"div\", {\n    className: styles.passBlock,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 21\n    }\n  }, __jsx(\"input\", {\n    className: styles.passInput,\n    type: togglePassword ? \"text\" : \"password\",\n    placeholder: \"\\u30D1\\u30B9\\u30EF\\u30FC\\u30C9\",\n    onChange: changePassword,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 25\n    }\n  }), __jsx(\"input\", {\n    className: styles.passButton,\n    type: \"button\",\n    value: togglePassword ? \"非表示\" : \"表示\",\n    onClick: togglePasswordDisplay,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 25\n    }\n  })), __jsx(\"p\", {\n    className: styles.alert,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 21\n    }\n  }, passwordError), __jsx(\"div\", {\n    className: styles.genderWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 21\n    }\n  }, __jsx(\"label\", {\n    className: styles.genderLeft,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 25\n    }\n  }, __jsx(\"input\", {\n    type: \"radio\",\n    value: \"\\u7537\",\n    name: \"gender\",\n    id: \"man\",\n    onChange: changeGender,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 29\n    }\n  }), __jsx(\"lavel\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 29\n    }\n  }, \"\\u7537\")), __jsx(\"label\", {\n    className: styles.genderRight,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 25\n    }\n  }, __jsx(\"input\", {\n    type: \"radio\",\n    value: \"\\u5973\",\n    name: \"gender\",\n    onChange: changeGender,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 29\n    }\n  }), __jsx(\"lavel\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 29\n    }\n  }, \"\\u5973\")))), __jsx(\"div\", {\n    className: styles.agree,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 17\n    }\n  }, __jsx(\"input\", {\n    id: \"agree\",\n    className: \"checkBox\",\n    type: \"checkbox\",\n    onClick: toggleChack,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 21\n    }\n  }), __jsx(\"label\", {\n    for: \"agree\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 21\n    }\n  }, \"\\u5229\\u7528\\u898F\\u7D04\\u3001\\u30D7\\u30E9\\u30A4\\u30D0\\u30B7\\u30FC\\u30DD\\u30EA\\u30B7\\u30FC\\u306B\\u540C\\u610F\\u3059\\u308B\")), __jsx(Link, {\n    href: \"/\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 17\n    }\n  }, __jsx(\"a\", {\n    className: styles.link,\n    target: \"blank\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 32\n    }\n  }, \"\\u5229\\u7528\\u898F\\u7D04\")), __jsx(Link, {\n    href: \"/\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 17\n    }\n  }, __jsx(\"a\", {\n    className: styles.link,\n    target: \"blank\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 32\n    }\n  }, \"\\u30D7\\u30E9\\u30A4\\u30D0\\u30B7\\u30FC\\u30DD\\u30EA\\u30B7\\u30FC\")), __jsx(\"p\", {\n    className: styles.alert,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 17\n    }\n  }, alert), __jsx(\"input\", {\n    className: check && FirstName && LastName && mail && password && gender ? styles.checked : styles.unChecked,\n    type: \"button\",\n    value: \"\\u4F5C\\u6210\\u3059\\u308B\",\n    onClick: check && FirstName && LastName && mail && password && gender ? handleSubmit : checkAlert,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 17\n    }\n  }), __jsx(\"div\", {\n    className: styles.bottom,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 17\n    }\n  }, __jsx(Link, {\n    href: \"/sign/signin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 21\n    }\n  }, __jsx(\"a\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 25\n    }\n  }, __jsx(\"button\", {\n    className: styles.button,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 28\n    }\n  }, \"\\u30ED\\u30B0\\u30A4\\u30F3\"))))));\n}","map":{"version":3,"sources":["/Users/tkak/sample/next5/villageon/pages/sign/signup.js"],"names":["Layout","Head","styles","useState","useEffect","Link","Router","initFirebase","firebase","require","db","firestore","SignUp","mail","setMail","password","setPassword","togglePassword","setTogglePassword","LastName","setLastName","FirstName","setFirstName","gender","setGender","mailError","setMailError","passwordError","setPasswordError","LastNameError","setLastNameError","FirstNameError","setFirstNameError","genderError","setGenderError","check","setCheck","alert","setAlert","mount","setMount","user","auth","currentUser","push","cleanup","changeLastName","event","target","value","changeFirstName","changeMail","changePassword","handleSubmit","createUserWithEmailAndPassword","then","updateProfile","displayName","collection","doc","uid","set","apllication","admin","first","last","catch","error","submitVerification","errorCode","code","errorMessage","message","checkAlert","toggleChack","changeGender","actionCodeSettings","url","sendEmailVerification","togglePasswordDisplay","signWrapper","title","form","nameWrapper","name","input","passBlock","passInput","passButton","genderWrapper","genderLeft","genderRight","agree","link","checked","unChecked","bottom","button"],"mappings":"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","sourcesContent":["import Layout from '../../components/layout'\nimport Head from 'next/head'\nimport styles from '../../styles/sign.module.scss'\nimport { useState, useEffect } from 'react'\nimport Link from 'next/link'\nimport Router from 'next/router'\n\nimport initFirebase from '../../components/initFirebase'\nimport firebase from \"firebase/app\"\nimport 'firebase/auth'\nrequire('firebase/auth')\nrequire(\"firebase/firestore\")\n\ninitFirebase()\nvar db = firebase.firestore()\n\nexport default function SignUp () {\n    //input\n    const [mail, setMail] = useState(\"\")\n    const [password, setPassword] = useState(\"\")\n    const [togglePassword, setTogglePassword] = useState(false)\n    const [LastName, setLastName] = useState(\"\")\n    const [FirstName, setFirstName] = useState(\"\")\n    const [gender, setGender] = useState(\"\")\n    //error\n    const [mailError, setMailError] = useState(\"\")\n    const [passwordError, setPasswordError] = useState(\"\")\n    const [LastNameError, setLastNameError] = useState(\"\")\n    const [FirstNameError, setFirstNameError] = useState(\"\")\n    const [genderError, setGenderError] = useState(\"\")\n    const [check, setCheck] = useState(false)\n    const [alert, setAlert] = useState(\"\")\n    //db\n    const [mount, setMount] = useState(true)\n    //verification\n\n    useEffect(() => {\n        if (mount) {\n            var user = firebase.auth().currentUser\n            if (user) {\n                if (process.browser) {\n                    Router.push(\"/user/details\")\n                }\n            }\n            /*\n            firebase.auth().onAuthStateChanged(function(user) {\n                if (user) {\n                    // User is signed in.\n                    if (process.browser) {\n                        Router.push(\"/\")\n                    }\n                } else {\n                    // No user is signed in.\n                }\n            })\n            */\n        }\n        return function cleanup() {\n            setMount(false)\n        }\n    })\n\n    \n    const changeLastName = event => {\n        const LastName = event.target.value\n        setLastName(LastName)\n    }\n\n    const changeFirstName = event => {\n        const FirstName = event.target.value\n        setFirstName(FirstName)\n    }\n\n    const changeMail = event => {\n        const mail = event.target.value\n        setMail(mail)\n    }\n    const changePassword = event => {\n        const password = event.target.value\n        setPassword(password)\n    }\n    const handleSubmit = () => {\n        setFirstNameError(\"\")\n        setLastNameError(\"\")\n        setMailError(\"\")\n        setPasswordError(\"\")\n        setAlert(\"\")\n        firebase.auth().createUserWithEmailAndPassword(mail, password).then(\n            function() {\n                var user = firebase.auth().currentUser\n                user.updateProfile({\n                    displayName: `${LastName} ${FirstName}`\n                })\n                db.collection(\"users\").doc(user.uid).set({\n                    apllication: [],\n                    admin: false,\n                    gender: gender,\n                    first: FirstName,\n                    last: LastName,\n                    mail: mail\n                }).then(function(){\n                }).catch(function(error){\n                })\n                submitVerification()\n            }).catch(\n            function(error) {\n                var errorCode = error.code\n                var errorMessage = error.message\n                if (errorCode == 'auth/invalid-email') {\n                    setMailError(\"正しいメールアドレスを入力してください\")\n                } else if (errorCode == 'auth/email-already-in-use') {\n                    setMailError(\"既に使われています\")\n                } else if (errorCode == 'auth/weak-password') {\n                    setPasswordError(\"6文字以上で設定してください\")\n                } else if (errorCode == 'auth/operation-not-allowed') {\n                    setMailError(\"メールアドレスを入力してください\")\n                } else {\n                    setPasswordError(errorMessage)\n                }\n                \n            }\n        )\n    }\n\n    const checkAlert = () => {\n        setFirstNameError(\"\")\n        setLastNameError(\"\")\n        setMailError(\"\")\n        setPasswordError(\"\")\n        setAlert(\"\")\n        if (!FirstName) {\n            setFirstNameError(\"入力してください\")\n            \n        } \n        if (!LastName) {\n            setLastNameError(\"入力してください\")\n        } \n        if (!mail) {\n            setMailError(\"入力してください\")\n        } \n        if (!password) {\n            setPasswordError(\"入力してください\")\n        } \n        if (!check) {\n            setAlert(\"利用規約に同意してください\")\n        }\n        if (gender) {\n            setGenderError(\"入力してください\")\n        }\n    }\n\n    const toggleChack = () => {\n        setCheck(!check)\n        setAlert(\"\")\n    }\n    \n    const changeGender = (event) => {\n        var gender = event.target.value\n        setGender(gender)\n    }\n\n    const submitVerification = ()　=> {\n        var actionCodeSettings = {\n            url: \"http://localhost:3000/user/details\",\n        }\n        var user = firebase.auth().currentUser\n        user.sendEmailVerification(actionCodeSettings).then(function() {\n            if (process.browser) {\n                Router.push(\"/sign/verification\")\n            }\n    }\n        )\n    }\n\n    const togglePasswordDisplay = () => {\n        setTogglePassword(!togglePassword)\n    }\n\n    return (\n        <Layout>\n            <Head>\n                <title>SignUp</title>\n            </Head>\n            <article className={styles.signWrapper}>\n                <h1 className={styles.title}>アカウントの作成</h1>\n                <form className={styles.form}> \n                    <div className={styles.nameWrapper}>\n                        <input className={styles.name} type=\"text\" placeholder=\"姓\" onChange={changeLastName} />\n                        <input className={styles.name} type=\"text\" placeholder=\"名\" onChange={changeFirstName} />\n                    </div>\n                    <div className={styles.nameWrapper}>\n                        <p className={styles.alert}>{LastNameError}</p>\n                        <p className={styles.alert}>{FirstNameError}</p>\n                    </div>\n                    <input className={styles.input} type=\"text\" placeholder=\"メールアドレス\" onChange={changeMail} />\n                    <p className={styles.alert}>{mailError}</p>\n                    <div className={styles.passBlock}>\n                        <input className={styles.passInput} type={togglePassword ? \"text\" : \"password\"} placeholder=\"パスワード\" onChange={changePassword} />\n                        <input className={styles.passButton} type=\"button\" value={togglePassword ? \"非表示\" : \"表示\"} onClick={togglePasswordDisplay}/>\n                    </div>\n                    <p className={styles.alert}>{passwordError}</p>\n                    <div className={styles.genderWrapper}>\n                        <label className={styles.genderLeft}>\n                            <input type=\"radio\" value=\"男\" name=\"gender\" id=\"man\" onChange={changeGender} />\n                            <lavel>男</lavel> \n                        </label>\n                        <label className={styles.genderRight}>\n                            <input type=\"radio\" value=\"女\" name=\"gender\" onChange={changeGender} />\n                            <lavel>女</lavel>\n                        </label>\n                    </div>\n                </form>\n                <div className={styles.agree}>\n                    <input id=\"agree\" className=\"checkBox\" type=\"checkbox\" onClick={toggleChack} />\n                    <label for=\"agree\">利用規約、プライバシーポリシーに同意する</label>\n                </div>\n                <Link href=\"/\"><a className={styles.link} target=\"blank\">利用規約</a></Link>\n                <Link href=\"/\"><a className={styles.link} target=\"blank\">プライバシーポリシー</a></Link>\n                <p className={styles.alert}>{alert}</p>\n                <input\n                    className={check && FirstName && LastName && mail && password && gender ? styles.checked : styles.unChecked}\n                    type=\"button\"\n                    value=\"作成する\"\n                    onClick={check && FirstName && LastName && mail && password && gender ? handleSubmit : checkAlert} />\n                <div className={styles.bottom}>\n                    <Link href=\"/sign/signin\">\n                        <a><button className={styles.button}>ログイン</button></a>\n                    </Link>\n                </div>\n            </article>\n        </Layout>\n    )\n}"]},"metadata":{},"sourceType":"module"}