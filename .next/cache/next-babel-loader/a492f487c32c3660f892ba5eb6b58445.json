{"ast":null,"code":"var _jsxFileName = \"/Users/tkak/sample/villageon/villageon/pages/sign/signup.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Layout, { url } from '../../components/layout';\nimport Head from 'next/head';\nimport styles from '../../styles/sign.module.scss';\nimport { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport Router from 'next/router';\nimport initFirebase from '../../components/initFirebase';\nimport firebase from \"firebase/app\";\nimport 'firebase/auth';\n\nrequire('firebase/auth');\n\nrequire(\"firebase/firestore\");\n\ninitFirebase();\nvar db = firebase.firestore();\nexport default function SignUp() {\n  _s();\n\n  //input\n  var _useState = useState(\"\"),\n      mail = _useState[0],\n      setMail = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      password = _useState2[0],\n      setPassword = _useState2[1];\n\n  var _useState3 = useState(false),\n      togglePassword = _useState3[0],\n      setTogglePassword = _useState3[1];\n\n  var _useState4 = useState(\"\"),\n      lastName = _useState4[0],\n      setLastName = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      firstName = _useState5[0],\n      setFirstName = _useState5[1];\n\n  var _useState6 = useState(\"\"),\n      gender = _useState6[0],\n      setGender = _useState6[1]; //error\n\n\n  var _useState7 = useState(\"\"),\n      mailError = _useState7[0],\n      setMailError = _useState7[1];\n\n  var _useState8 = useState(\"\"),\n      passwordError = _useState8[0],\n      setPasswordError = _useState8[1];\n\n  var _useState9 = useState(\"\"),\n      nameError = _useState9[0],\n      setNameError = _useState9[1];\n\n  var _useState10 = useState(\"\"),\n      genderError = _useState10[0],\n      setGenderError = _useState10[1];\n\n  var _useState11 = useState(false),\n      check = _useState11[0],\n      setCheck = _useState11[1];\n\n  var _useState12 = useState(\"\"),\n      alert = _useState12[0],\n      setAlert = _useState12[1]; //db\n\n\n  var _useState13 = useState(true),\n      mount = _useState13[0],\n      setMount = _useState13[1]; //verification\n\n\n  useEffect(function () {\n    if (mount) {\n      var user = firebase.auth().currentUser;\n\n      if (user) {\n        if (true) {\n          Router.push(\"/user/details\");\n        }\n      }\n\n      firebase.auth().onAuthStateChanged(function (user) {\n        if (user) {\n          // User is signed in.\n          if (true) {\n            Router.push(\"/\");\n          }\n        } else {// No user is signed in.\n        }\n      });\n    }\n\n    return function cleanup() {\n      setMount(false);\n    };\n  });\n\n  var changeLastName = function changeLastName(event) {\n    var LastName = event.target.value;\n    setLastName(LastName);\n  };\n\n  var changeFirstName = function changeFirstName(event) {\n    var FirstName = event.target.value;\n    setFirstName(FirstName);\n  };\n\n  var changeMail = function changeMail(event) {\n    var mail = event.target.value;\n    setMail(mail);\n  };\n\n  var changePassword = function changePassword(event) {\n    var password = event.target.value;\n    setPassword(password);\n  };\n\n  var handleSubmit = function handleSubmit() {\n    setNameError(\"\");\n    setMailError(\"\");\n    setPasswordError(\"\");\n    setAlert(\"\");\n    firebase.auth().createUserWithEmailAndPassword(mail, password).then(function () {\n      var user = firebase.auth().currentUser;\n      user.updateProfile({\n        displayName: \"\".concat(lastName, \" \").concat(firstName)\n      });\n      db.collection(\"users\").doc(user.uid).set({\n        apllication: [],\n        admin: false,\n        gender: gender,\n        first: firstName,\n        last: lastName,\n        mail: mail\n      }).then(function () {})[\"catch\"](function (error) {});\n      submitVerification();\n    })[\"catch\"](function (error) {\n      var errorCode = error.code;\n      var errorMessage = error.message;\n\n      if (errorCode == 'auth/invalid-email') {\n        setMailError(\"正しいメールアドレスを入力してください\");\n      } else if (errorCode == 'auth/email-already-in-use') {\n        setMailError(\"既に使われています\");\n      } else if (errorCode == 'auth/weak-password') {\n        setPasswordError(\"6文字以上で設定してください\");\n      } else if (errorCode == 'auth/operation-not-allowed') {\n        setMailError(\"メールアドレスを入力してください\");\n      } else {\n        setPasswordError(errorMessage);\n      }\n    });\n  };\n\n  var checkAlert = function checkAlert() {\n    setNameError(\"\");\n    setMailError(\"\");\n    setPasswordError(\"\");\n    setAlert(\"\");\n\n    if (!firstName || !lastName) {\n      setNameError(\"入力してください\");\n    }\n\n    if (!mail) {\n      setMailError(\"入力してください\");\n    }\n\n    if (!password) {\n      setPasswordError(\"入力してください\");\n    }\n\n    if (!check) {\n      setAlert(\"利用規約に同意してください\");\n    }\n\n    if (gender) {\n      setGenderError(\"入力してください\");\n    }\n  };\n\n  var toggleChack = function toggleChack() {\n    setCheck(!check);\n    setAlert(\"\");\n  };\n\n  var changeGender = function changeGender(event) {\n    var gender = event.target.value;\n    setGender(gender);\n  };\n\n  var submitVerification = function submitVerification() {\n    var actionCodeSettings = {\n      url: \"\".concat(url, \"/user/details\")\n    };\n    var user = firebase.auth().currentUser;\n    user.sendEmailVerification(actionCodeSettings).then(function () {\n      if (true) {\n        Router.push(\"/sign/verification\");\n      }\n    });\n  };\n\n  var togglePasswordDisplay = function togglePasswordDisplay() {\n    setTogglePassword(!togglePassword);\n  };\n\n  return __jsx(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 9\n    }\n  }, __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }\n  }, __jsx(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 17\n    }\n  }, \"SignUp\")), __jsx(\"article\", {\n    className: \" flex flex-col justify-center items-center bg-white w-full my-6 p-6 shadow sm:max-w-lg sm:mx-auto sm:rounded\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 13\n    }\n  }, __jsx(\"h1\", {\n    className: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 17\n    }\n  }, \"\\u30A2\\u30AB\\u30A6\\u30F3\\u30C8\\u306E\\u4F5C\\u6210\"), __jsx(\"div\", {\n    className: \"flex flex-col w-full justify-center items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 17\n    }\n  }, __jsx(\"input\", {\n    className: \"w-full border-solid border-2 rounded p-2 outline-none my-1 max-w-sm\",\n    type: \"text\",\n    placeholder: \"\\u59D3\",\n    onChange: changeLastName,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 21\n    }\n  }), __jsx(\"input\", {\n    className: \"w-full border-solid border-2 rounded p-2 outline-none my-1 max-w-sm\",\n    type: \"text\",\n    placeholder: \"\\u540D\",\n    onChange: changeFirstName,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 21\n    }\n  })), __jsx(\"p\", {\n    className: \"text-red-600\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 17\n    }\n  }, nameError), __jsx(\"input\", {\n    className: \"border-solid border-2 rounded p-2 w-full outline-none max-w-sm my-1\",\n    type: \"text\",\n    placeholder: \"\\u30E1\\u30FC\\u30EB\\u30A2\\u30C9\\u30EC\\u30B9\",\n    onChange: changeMail,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 17\n    }\n  }), __jsx(\"p\", {\n    className: \"text-red-600\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 17\n    }\n  }, mailError), __jsx(\"div\", {\n    className: \"border-solid border-2 rounded p-2 w-full flex max-w-sm my-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 17\n    }\n  }, __jsx(\"input\", {\n    className: \"w-4/5 outline-none\",\n    type: togglePassword ? \"text\" : \"password\",\n    placeholder: \"\\u30D1\\u30B9\\u30EF\\u30FC\\u30C9\",\n    onChange: changePassword,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 21\n    }\n  }), __jsx(\"input\", {\n    className: \"w-1/5 outline-none bg-white opacity-50\",\n    type: \"button\",\n    value: togglePassword ? \"非表示\" : \"表示\",\n    onClick: togglePasswordDisplay,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 21\n    }\n  })), __jsx(\"p\", {\n    className: \"text-red-600\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 17\n    }\n  }, passwordError), __jsx(\"div\", {\n    className: \"flex justify-between w-full max-w-sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 17\n    }\n  }, __jsx(\"label\", {\n    className: \"w-5/12 border-solid border-2 rounded p-2 outline-none my-1 flex items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 21\n    }\n  }, __jsx(\"input\", {\n    type: \"radio\",\n    value: \"\\u7537\",\n    name: \"gender\",\n    id: \"man\",\n    onChange: changeGender,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 25\n    }\n  }), __jsx(\"lavel\", {\n    className: \"pl-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 25\n    }\n  }, \"\\u7537\")), __jsx(\"label\", {\n    className: \"w-5/12 border-solid border-2 rounded p-2 outline-none my-1 flex items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 21\n    }\n  }, __jsx(\"input\", {\n    type: \"radio\",\n    value: \"\\u5973\",\n    name: \"gender\",\n    onChange: changeGender,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 25\n    }\n  }), __jsx(\"lavel\", {\n    className: \"pl-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 25\n    }\n  }, \"\\u5973\"))), __jsx(\"div\", {\n    className: styles.agree,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 17\n    }\n  }, __jsx(\"input\", {\n    id: \"agree\",\n    className: \"checkBox\",\n    type: \"checkbox\",\n    onClick: toggleChack,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 21\n    }\n  }), __jsx(\"label\", {\n    \"for\": \"agree\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 21\n    }\n  }, \"\\u5229\\u7528\\u898F\\u7D04\\u3001\\u30D7\\u30E9\\u30A4\\u30D0\\u30B7\\u30FC\\u30DD\\u30EA\\u30B7\\u30FC\\u306B\\u540C\\u610F\\u3059\\u308B\")), __jsx(Link, {\n    href: \"/info/tos\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 17\n    }\n  }, __jsx(\"a\", {\n    className: styles.link,\n    target: \"blank\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 40\n    }\n  }, \"\\u5229\\u7528\\u898F\\u7D04\")), __jsx(Link, {\n    href: \"/info/privacy\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 17\n    }\n  }, __jsx(\"a\", {\n    className: styles.link,\n    target: \"blank\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 44\n    }\n  }, \"\\u30D7\\u30E9\\u30A4\\u30D0\\u30B7\\u30FC\\u30DD\\u30EA\\u30B7\\u30FC\")), __jsx(\"p\", {\n    className: styles.alert,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 17\n    }\n  }, alert), __jsx(\"input\", {\n    className: \"border-none rounded p-2 w-full outline-none max-w-sm my-1 bg-blue-200\",\n    type: \"button\",\n    value: \"\\u4F5C\\u6210\\u3059\\u308B\",\n    onClick: check && firstName && lastName && mail && password && gender ? handleSubmit : checkAlert,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 17\n    }\n  }), __jsx(Link, {\n    href: \"/sign/signin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 17\n    }\n  }, __jsx(\"a\", {\n    className: \"w-full max-w-sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 21\n    }\n  }, __jsx(\"input\", {\n    type: \"button\",\n    value: \"\\u30ED\\u30B0\\u30A4\\u30F3\",\n    className: \"cursor-pointer border-solid border-2 rounded p-2 w-full outline-none max-w-sm my-1 bg-white\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 52\n    }\n  })))));\n}\n\n_s(SignUp, \"03vZJVlv3ptoxtTYFoNus2gKOxA=\");\n\n_c = SignUp;\n\nvar _c;\n\n$RefreshReg$(_c, \"SignUp\");","map":{"version":3,"sources":["/Users/tkak/sample/villageon/villageon/pages/sign/signup.js"],"names":["Layout","url","Head","styles","useState","useEffect","Link","Router","initFirebase","firebase","require","db","firestore","SignUp","mail","setMail","password","setPassword","togglePassword","setTogglePassword","lastName","setLastName","firstName","setFirstName","gender","setGender","mailError","setMailError","passwordError","setPasswordError","nameError","setNameError","genderError","setGenderError","check","setCheck","alert","setAlert","mount","setMount","user","auth","currentUser","push","onAuthStateChanged","cleanup","changeLastName","event","LastName","target","value","changeFirstName","FirstName","changeMail","changePassword","handleSubmit","createUserWithEmailAndPassword","then","updateProfile","displayName","collection","doc","uid","set","apllication","admin","first","last","error","submitVerification","errorCode","code","errorMessage","message","checkAlert","toggleChack","changeGender","actionCodeSettings","sendEmailVerification","togglePasswordDisplay","agree","link"],"mappings":"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","sourcesContent":["import Layout, { url } from '../../components/layout'\nimport Head from 'next/head'\nimport styles from '../../styles/sign.module.scss'\nimport { useState, useEffect } from 'react'\nimport Link from 'next/link'\nimport Router from 'next/router'\n\nimport initFirebase from '../../components/initFirebase'\nimport firebase from \"firebase/app\"\nimport 'firebase/auth'\nrequire('firebase/auth')\nrequire(\"firebase/firestore\")\n\ninitFirebase()\nvar db = firebase.firestore()\n\nexport default function SignUp () {\n    //input\n    const [mail, setMail] = useState(\"\")\n    const [password, setPassword] = useState(\"\")\n    const [togglePassword, setTogglePassword] = useState(false)\n    const [lastName, setLastName] = useState(\"\")\n    const [firstName, setFirstName] = useState(\"\")\n    const [gender, setGender] = useState(\"\")\n    //error\n    const [mailError, setMailError] = useState(\"\")\n    const [passwordError, setPasswordError] = useState(\"\")\n    const [nameError, setNameError] = useState(\"\")\n    const [genderError, setGenderError] = useState(\"\")\n    const [check, setCheck] = useState(false)\n    const [alert, setAlert] = useState(\"\")\n    //db\n    const [mount, setMount] = useState(true)\n    //verification\n\n    useEffect(() => {\n        if (mount) {\n            var user = firebase.auth().currentUser\n            if (user) {\n                if (process.browser) {\n                    Router.push(\"/user/details\")\n                }\n            }\n            \n            firebase.auth().onAuthStateChanged(function(user) {\n                if (user) {\n                    // User is signed in.\n                    if (process.browser) {\n                        Router.push(\"/\")\n                    }\n                } else {\n                    // No user is signed in.\n                }\n            })\n            \n        }\n        return function cleanup() {\n            setMount(false)\n        }\n    })\n\n    \n    const changeLastName = event => {\n        const LastName = event.target.value\n        setLastName(LastName)\n    }\n\n    const changeFirstName = event => {\n        const FirstName = event.target.value\n        setFirstName(FirstName)\n    }\n\n    const changeMail = event => {\n        const mail = event.target.value\n        setMail(mail)\n    }\n    const changePassword = event => {\n        const password = event.target.value\n        setPassword(password)\n    }\n    const handleSubmit = () => {\n        setNameError(\"\")\n        setMailError(\"\")\n        setPasswordError(\"\")\n        setAlert(\"\")\n        firebase.auth().createUserWithEmailAndPassword(mail, password).then(\n            function() {\n                var user = firebase.auth().currentUser\n                user.updateProfile({\n                    displayName: `${lastName} ${firstName}`\n                })\n                db.collection(\"users\").doc(user.uid).set({\n                    apllication: [],\n                    admin: false,\n                    gender: gender,\n                    first: firstName,\n                    last: lastName,\n                    mail: mail\n                }).then(function(){\n                }).catch(function(error){\n                })\n                submitVerification()\n            }).catch(\n            function(error) {\n                var errorCode = error.code\n                var errorMessage = error.message\n                if (errorCode == 'auth/invalid-email') {\n                    setMailError(\"正しいメールアドレスを入力してください\")\n                } else if (errorCode == 'auth/email-already-in-use') {\n                    setMailError(\"既に使われています\")\n                } else if (errorCode == 'auth/weak-password') {\n                    setPasswordError(\"6文字以上で設定してください\")\n                } else if (errorCode == 'auth/operation-not-allowed') {\n                    setMailError(\"メールアドレスを入力してください\")\n                } else {\n                    setPasswordError(errorMessage)\n                }\n                \n            }\n        )\n    }\n\n    const checkAlert = () => {\n        setNameError(\"\")\n        setMailError(\"\")\n        setPasswordError(\"\")\n        setAlert(\"\")\n        if (!firstName || !lastName) {\n            setNameError(\"入力してください\")\n            \n        } \n        if (!mail) {\n            setMailError(\"入力してください\")\n        } \n        if (!password) {\n            setPasswordError(\"入力してください\")\n        } \n        if (!check) {\n            setAlert(\"利用規約に同意してください\")\n        }\n        if (gender) {\n            setGenderError(\"入力してください\")\n        }\n    }\n\n    const toggleChack = () => {\n        setCheck(!check)\n        setAlert(\"\")\n    }\n    \n    const changeGender = (event) => {\n        var gender = event.target.value\n        setGender(gender)\n    }\n\n    const submitVerification = ()　=> {\n        var actionCodeSettings = {\n            url: `${url}/user/details`,\n        }\n        var user = firebase.auth().currentUser\n        user.sendEmailVerification(actionCodeSettings).then(function() {\n            if (process.browser) {\n                Router.push(\"/sign/verification\")\n            }\n    }\n        )\n    }\n\n    const togglePasswordDisplay = () => {\n        setTogglePassword(!togglePassword)\n    }\n\n    return (\n        <Layout>\n            <Head>\n                <title>SignUp</title>\n            </Head>\n            <article className=\"\n                flex flex-col justify-center items-center bg-white w-full my-6 p-6 shadow\n                sm:max-w-lg sm:mx-auto sm:rounded\">\n                <h1 className=\"\">アカウントの作成</h1>\n                <div className=\"flex flex-col w-full justify-center items-center\">\n                    <input className=\"w-full border-solid border-2 rounded p-2 outline-none my-1 max-w-sm\" type=\"text\" placeholder=\"姓\" onChange={changeLastName} />\n                    <input className=\"w-full border-solid border-2 rounded p-2 outline-none my-1 max-w-sm\" type=\"text\" placeholder=\"名\" onChange={changeFirstName} />\n                </div>\n                <p className=\"text-red-600\">{nameError}</p>\n                <input className=\"border-solid border-2 rounded p-2 w-full outline-none max-w-sm my-1\" type=\"text\" placeholder=\"メールアドレス\" onChange={changeMail} />\n                <p className=\"text-red-600\">{mailError}</p>\n                <div className=\"border-solid border-2 rounded p-2 w-full flex max-w-sm my-1\">\n                    <input className=\"w-4/5 outline-none\" type={togglePassword ? \"text\" : \"password\"} placeholder=\"パスワード\" onChange={changePassword} />\n                    <input className=\"w-1/5 outline-none bg-white opacity-50\" type=\"button\" value={togglePassword ? \"非表示\" : \"表示\"} onClick={togglePasswordDisplay}/>\n                </div>\n                <p className=\"text-red-600\">{passwordError}</p>\n                <div className=\"flex justify-between w-full max-w-sm\">\n                    <label className=\"w-5/12 border-solid border-2 rounded p-2 outline-none my-1 flex items-center\">\n                        <input type=\"radio\" value=\"男\" name=\"gender\" id=\"man\" onChange={changeGender} />\n                        <lavel className=\"pl-4\">男</lavel> \n                    </label>\n                    <label className=\"w-5/12 border-solid border-2 rounded p-2 outline-none my-1 flex items-center\">\n                        <input type=\"radio\" value=\"女\" name=\"gender\" onChange={changeGender} />\n                        <lavel className=\"pl-4\">女</lavel>\n                    </label>\n                </div>\n                <div className={styles.agree}>\n                    <input id=\"agree\" className=\"checkBox\" type=\"checkbox\" onClick={toggleChack} />\n                    <label for=\"agree\">利用規約、プライバシーポリシーに同意する</label>\n                </div>\n                <Link href=\"/info/tos\"><a className={styles.link} target=\"blank\">利用規約</a></Link>\n                <Link href=\"/info/privacy\"><a className={styles.link} target=\"blank\">プライバシーポリシー</a></Link>\n                <p className={styles.alert}>{alert}</p>\n                <input\n                    className=\"border-none rounded p-2 w-full outline-none max-w-sm my-1 bg-blue-200\"\n                    type=\"button\"\n                    value=\"作成する\"\n                    onClick={check && firstName && lastName && mail && password && gender ? handleSubmit : checkAlert} />\n                <Link href=\"/sign/signin\">\n                    <a className=\"w-full max-w-sm\"><input type=\"button\" value=\"ログイン\" className=\"cursor-pointer border-solid border-2 rounded p-2 w-full outline-none max-w-sm my-1 bg-white\"/></a>\n                </Link>\n            </article>\n        </Layout>\n    )\n}"]},"metadata":{},"sourceType":"module"}